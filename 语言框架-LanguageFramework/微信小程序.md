# 微信小程序

## 优势

1. 微信有用户基础  
2. 现行环境推广app或者公众号的成本太高  
3. 开发适配成本低  
4. 容易小规模试错然后快速迭代  
5. 跨平台  

## 开发环境

>微信官方小程序开发工具  
>vscode

## 小程序框架原生框架-MINA

1. 结构,也就是,WXML-->对应HTML

2. 样式,也就是,WXSS-->对应CSS

3. 逻辑,通用的JS

4. 配置,JSON

## 基本的项目目录

>pages页面文件夹
>>app.js-项目的全局入口文件  
>>app.wxss-全局样式  
>>app.json-全局配置文件  
>>util文件夹  
>>>util.js-utils第三方的工具js 

>>index首页文件夹  
>>>index.js逻辑  
>>>index.json配置-页面配置文件可以针对单独页面进行各种字段的配置  
>>>index.wxml结构  
>>>index.wxss样式  

>>logs日志界面文件夹  
>>>logs.js  
>>>logs.json  
>>>logs.wxml  
>>>logs.wxss  

1. 全局配置文件app.js  
   #### pages-页面注册位置  
    >**新增页面**  
    >在这里增加字段并保存，就能自动生成相关文件**PS:必须在微信开发者工具中**  
    >**界面显示顺序**  
    >调整先后顺序即可，谁在最上面就显示谁  
   #### windows  
   全局默认的状态栏、导航条、标题、窗口背景色  
      
   #### tabbar-下面的导航栏
    值为list列表，其中至少2个元素其中元素有两个字段:    
      1. pagePath 跳转到的页面路径  
      2. text-按钮下方的文字  
      3. iconPath-未选中的图标``"文件夹/图片名"``  
      4. selectedIconPath-被选中之后的图标``"文件夹/图片名"``  

    有许多字段，详见[文档][1]

1. project.config.json项目的配置文件

2. sitemap.json微信索引配置文件

用于配置小程序及其页面是否允许被微信索引

## WXSS

### 注意

rpx
规定屏幕有750rpx，无论物理屏幕像素大小
需要将页面中某些元素的单位由像素大小改为rpx（这样元素就会等比例放缩）
如果要在css中计算单位，使用calc()
数字与单位不要有空格，运算符两边必须要空格
不需要在WXML中引入样式文件，会找到同名的WXSS文件自动引入

### 样式导入

导入其他的WXSS样式文件
@import "相对路径";

### 选择器

基本与css是一致的，除了不支持通配符*

### 如何使用less语法

在vscode中安装easy less
在vscode设置中加入配置

   "less.compile":{"outExt":".WXSS"}

首先在vscode中将WXSS后缀名改为less
然后编写less
按保存之后，即可生成后缀为WXSS的文件

## 组件
（也就是标签）

### view标签
相当于div标签 块级元素 默认换行

### text标签
相当于span标签 行内元素 不会换行

里面只能嵌套text标签
只有它能实现长按文本复制
可以编译空格、回车

### checkbox标签
相当于之前的复选标签

### block标签
占位符标签
写代码的时候可以看到该标签
页面渲染时小程序会将其移除


## 语法
1. 参数的传递  
   1. JS-->WXML  
       **JS部分**  
       同名的js文件中有一个page函数,其参数为一个**字典**,
       >用于传参的键为**data**  
       >值是字典,字典中就是传递进WXML中的参数的集合  
       >允许的数字类型有**字符串,数字,bool类型,字典**

       **WXML部分**  
       **``{{键名}}``**  
      即可引用js部分中**键data**对应的**字典**中的"键名"对应的内容  
      注意传递bool类型时，字符串与空格中不能存在空格，会识别失败(在新版中似乎不在需要这么做)  
       **``{{变量名.键名}}``**  
      用于读取**嵌套**的数据结构   
       **运算**  
      可以在{{}}中添加一些表达式   
      1. 数字的运算``{{1+1}}``
      1. 字符串拼接``{{'1'+'1'}}``  
      1. 三元表达式``{{10%2===0 ? '偶数' : '奇数'}}``
   2. WXML-->JS  
        **WXML部分**  
        只能通过自定义属性的方式将参数传入JS  
        ``<button bindtap="函数名" 自定义的属性="{{参数}}"></button>``  
        **JS部分**  
        可以在事件源对象中找到此属性  
        通过事件源对象获取对应属性  
        ``this.setData({data中的键:想给的值})``  
        如果只在JS中对data中的对象修改,不去setData,界面的内容不会改变,但是! JS里变量的改变是在**积累**的  
        相当于一种**更新**的机制
2. 列表渲染
   1. 对列表或者字典进行for循环
        ```
        WXML中
        wx:for="{{数组}}"  
        wx:for-item="循环项的名称"
        wx:for-index="循环项的索引"
        比如:<view wx:for"{{list}}" wx:for-item="item" wx:for-index="index"/>

        JS中
        page(
            data:{
                ...
                list:[字典1，字典2......],
                ...
            }
        )
        ```
        **索引**，即0,1,2,3,4,5....，是可以在此view内层中用模板语法{{}}引用的变量  
        **循环项名称**，即这个列表中的元素1，元素2，元素3......也是可以在内层用模板语法引用
   2. 对**对象**进行for循环
        ```
        wx:for="{{对象}}"  
        wx:for-item="对象的值"
        wx:for-index="对象的属性"

        <view wx:for"{{list}}" wx:for-item="item" wx:for-index="index"/>
        ```
   3. 指定for语句的key``wx:key="唯一的值"``  
        如果列表中项目的位置会**动态改变**或者**有新的项目添加到列表中**，并且希望列表中的项目**保持自己的特征和状态**（如 input 中的输入内容，switch 的选中状态），需要使用 wx:key 来指定列表中项目的**唯一的标识符**。对于key的设定有**两种方式**,需要根据循环的内容而定  
       1. key为字符串  
        用于循环对象为**对象**时  
        此字符串必须为循环数组中的对象的唯一属性（其值是不重复的）
       2. key为"*this"  
        表示键是循环时取出的元素,需要这些元素都是唯一的
       3. 另外  
        总之就是:key需要一个不重复的值充当"主键"  
        还有:如果此列表**不会产生任何变化**，那么也不需要提供key,~~你真的确定永远都不需要嘛~~
   4. 小贴士  
    当出现wx:for循环重复嵌套时，要注意不同循环的item与index不能重名  
    不写wx:for-index与wx:for-item时，默认的循环项与索引的名称就是item与index

3. 条件渲染

   1. 单层判断

    ``<view wx:if="{{true}}"></view>``

   2. 多层判断
    ```
    <view wx:if="{{true}}"></view>
    <view wx:elif="{{true}}"></view>
    ```
   3. hidden        
       1. 作为属性使用  
        ``<view hidden></view>``不要和display样式一起使用       
       2. 作为模板语法使用  
        ``<view hidden={{true}}></view>``
   4. 以上两者如何选择  
    当标签频繁切换显示时,优先使用hidden,因为hidden是将元素**隐藏**,反之，优先使用wx:if,因为wx:if是将元素**移除**  
4. 事件绑定   
   **WXML部分**  
   在对应的元素中绑定事件发生时对应的函数        
   **JS部分**  
   在page中编写WXML中绑定的函数内容  
        函数名：与WXML中同名  
        输入值：事件源对象  
        PS：可以利用**console.log**打印出来，往往有你想要的内容  

[1]:https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/page.html